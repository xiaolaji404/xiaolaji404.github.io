<!DOCTYPE html><html lang="en" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/xiaolaji.ico"><link rel="icon" href="/img/xiaolaji.ico"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"><meta name="theme-color" content="#2f4154"><meta name="author" content="Xiaolaji"><meta name="keywords" content=""><meta name="description" content="通配符 通配符是shell在做PathnameExpansion时用到的。说白了一般只用于文件名匹配，它是由shell解析 的，比如 find，ls，cp，mv等 shell常见通配符 123456*：匹配0或多个字符?：匹配任意一个字符[list]：匹配list中任意单个字符[c1‐c2]：匹配c1‐c2中任意单个字符[^c1‐c2]&#x2F;[!c1‐c2]：不匹配c1‐c2中任意字符&amp;#123;st"><meta property="og:type" content="article"><meta property="og:title" content="文本三剑客"><meta property="og:url" content="https://xiaolaji.site/20220905/%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2/index.html"><meta property="og:site_name" content="星陨的博客"><meta property="og:description" content="通配符 通配符是shell在做PathnameExpansion时用到的。说白了一般只用于文件名匹配，它是由shell解析 的，比如 find，ls，cp，mv等 shell常见通配符 123456*：匹配0或多个字符?：匹配任意一个字符[list]：匹配list中任意单个字符[c1‐c2]：匹配c1‐c2中任意单个字符[^c1‐c2]&#x2F;[!c1‐c2]：不匹配c1‐c2中任意字符&amp;#123;st"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://xiaolaji.site/Photo/Blog_Photo/index/%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2.jpg"><meta property="article:published_time" content="2022-09-05T04:25:00.000Z"><meta property="article:modified_time" content="2023-05-27T14:34:14.000Z"><meta property="article:author" content="Xiaolaji"><meta property="article:tag" content="文本三剑客"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://xiaolaji.site/Photo/Blog_Photo/index/%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2.jpg"><meta name="referrer" content="no-referrer-when-downgrade"><title>文本三剑客 - 星陨的博客</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"xiaolaji.site",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:"0eb40f8e6a255579dc28fb908c7f25f5",google:5113481912,gtag:"G-LVS4PR7N6S",tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:"btVVcNFUfRauRrpzv6fApy2i-MdYXbMMI",app_key:"e4z3ib7tRXBdPHQR792zwJft",server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>var _hmt;Fluid.ctx.dnt||(_hmt=_hmt||[],function(){var t=document.createElement("script"),e=(t.src="https://hm.baidu.com/hm.js?0eb40f8e6a255579dc28fb908c7f25f5",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}())</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.google-analytics.com/analytics.js",function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","5113481912","auto"),ga("send","pageview")})</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-LVS4PR7N6S",function(){function a(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],a("js",new Date),a("config","G-LVS4PR7N6S")})</script><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="星陨的博客" type="application/atom+xml"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>星陨的博客</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>主页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/Photo/Blog_Photo/Banner/%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="文本三剑客"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> Xiaolaji </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-09-05 12:25" pubdate>September 5, 2022 pm</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 25k words </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 26 mins </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> views</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar category-bar" style="margin-right:-1rem"><div class="category-list"><div class="category row nomargin-x"><a class="category-item list-group-item category-item-action col-10 col-md-11 col-xm-11" title="Linux" id="heading-edc9f0a5a5d57797bf68e37364743831" role="tab" data-toggle="collapse" href="#collapse-edc9f0a5a5d57797bf68e37364743831" aria-expanded="true">Linux <span class="list-group-count">(6)</span> <i class="iconfont icon-arrowright"></i></a><div class="category-collapse collapse show" id="collapse-edc9f0a5a5d57797bf68e37364743831" role="tabpanel" aria-labelledby="heading-edc9f0a5a5d57797bf68e37364743831"><div class="category-post-list"><a href="/20220905/Linux%E5%91%BD%E4%BB%A4%E8%A1%8C/" title="Linux命令行" class="list-group-item list-group-item-action"><span class="category-post">Linux命令行</span> </a><a href="/20220905/Linux%E5%9F%BA%E7%A1%80/" title="Linux基础" class="list-group-item list-group-item-action"><span class="category-post">Linux基础</span> </a><a href="/20221003/Linux%E6%96%87%E4%BB%B6%E5%9F%BA%E6%9C%AC%E5%B1%9E%E6%80%A7%E4%B8%8E%E6%96%87%E4%BB%B6%E6%9F%A5%E6%89%BE/" title="Linux文件基本属性与文件查找" class="list-group-item list-group-item-action"><span class="category-post">Linux文件基本属性与文件查找</span> </a><a href="/20220905/Linux%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" title="Linux文件管理" class="list-group-item list-group-item-action"><span class="category-post">Linux文件管理</span> </a><a href="/20221003/Linux%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" title="Linux用户权限管理" class="list-group-item list-group-item-action"><span class="category-post">Linux用户权限管理</span> </a><a href="/20220905/%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2/" title="文本三剑客" class="list-group-item list-group-item-action active"><span class="category-post">文本三剑客</span></a></div></div></div></div></aside></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">文本三剑客</h1><div class="markdown-body"><h1>通配符</h1><p>通配符是shell在做PathnameExpansion时用到的。说白了一般只用于文件名匹配，它是由shell解析 的，比如 find，ls，cp，mv等 shell常见通配符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">*：匹配0或多个字符<br>?：匹配任意一个字符<br>[list]：匹配list中任意单个字符<br>[c1‐c2]：匹配c1‐c2中任意单个字符<br>[^c1‐c2]/[!c1‐c2]：不匹配c1‐c2中任意字符<br>&#123;string1,string2,...&#125;：匹配&#123;&#125;中任意单个字符串<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>shell 元字符</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell">IFS：&lt;tab&gt;/&lt;space&gt;/&lt;enter&gt;<br>CR：&lt;enter&gt;<br>=：设定变量<br><span class="hljs-meta prompt_">$</span><span class="language-bash">：取变量值</span><br><span class="hljs-meta prompt_">&gt;</span><span class="language-bash">/&lt; ：重定向</span><br>|：管道<br>&amp;：后台执行命令<br>()：在子shell中执行命令/运算或命令替换<br>&#123;&#125;：函数中执行/变量替换的界定范围<br>;：命令结束后，忽略其返回值，继续执行下一个命令<br>&amp;&amp;：命令结束后，若为true，继续执行下一个命令<br>||：命令结束后，若为false，继续执行下一个命令<br>！：非<br><span class="hljs-meta prompt_">#</span><span class="language-bash">：注释</span><br>\：转义符<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>shell转义符</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">&#x27;&#x27;：硬转义，内部所有shell元字符，通配符都会被关掉<br>&quot;&quot;：软转义，内部<br></code></pre></td></tr></table></figure><h1>find文件查找</h1><ul class="lvl-0"><li class="lvl-2"><p>实时查找工具，通过遍历指定路径下的文件系统完成文件查找</p></li><li class="lvl-2"><p>工作特点</p><ul class="lvl-2"><li class="lvl-4">查找速度略慢</li><li class="lvl-4">精确查找</li><li class="lvl-4">实时查找</li><li class="lvl-4">可以满足多种条件匹配</li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">find [选项] [路径] [查找条件 + 处理动作]<br>查找路径：指定具体目录路径，默认是当前文件夹<br>查找条件：指定的查找标准（文件名/大小/类型/权限等），默认是找出所有文件<br>处理动作：对符合条件的文件做什么操作，默认输出屏幕<br></code></pre></td></tr></table></figure><h2 id="查找条件">查找条件</h2><ul class="lvl-0"><li class="lvl-2"><p>查找条件</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs shell">根据文件名查找：<br>    ‐name &quot;filename&quot; 支持global<br>    ‐iname &quot;filename&quot; 忽略大小写<br>    ‐regex &quot;PATTERN&quot; 以Pattern匹配整个文件路径字符串，而不仅仅是文件名称<br>根据属主和属组查找：<br>    ‐user USERNAME：查找属主为指定用户的文件<br>    ‐group GROUPNAME：查找属组为指定属组的文件<br>    ‐uid UserID：查找属主为指定的ID号的文件<br>    ‐gid GroupID：查找属组为指定的GID号的文件<br>    ‐nouser：查找没有属主的文件<br>    ‐nogroup：查找没有属组的文件<br>根据文件类型查找：<br>    ‐type Type：<br>    f/d/l/s/b/c/p<br>根据文件大小来查找：<br>	‐size [+|‐]N[bcwkMG]<br>根据时间戳:<br>    天：<br>        ‐atime [+|‐]N<br>        ‐mtime<br>        ‐ctime<br>    分钟：<br>        ‐amin N<br>        ‐cmin N<br>        ‐mmin N<br>根据权限查找：<br>    ‐perm [+|‐]MODE<br>    MODE：精确权限匹配<br>    /MODE：任何一类(u，g，o)对象的权限中只要能一位匹配即可<br>    ‐MODE：每一类对象都必须同时拥有为其指定的权限标准<br>组合条件：<br>    与：‐a<br>    或：‐o<br>    非：‐not<br>相关案例：找出/tmp目录下，属主不是root，且文件名不是fstab的文件：<br>find /tmp \( -not -user root -a -not -name fstab \) -ls<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>根据文件名查找</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find /etc -name &quot;ifcfg-ens33&quot;<br>[root@localhost ~]# find /etc -iname &quot;ifcfg-ens33&quot; # 忽略大小写<br>[root@localhost ~]# find /etc -iname &quot;ifcfg*&quot;<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>按文件大小</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find /etc -size +5M # 大于5M<br>[root@localhost ~]# find /etc -size 5M # 等于5M<br>[root@localhost ~]# find /etc -size -5M # 小于5M<br>[root@localhost ~]# find /etc -size +5M -ls # 找到的处理动作-ls<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>指定查找的目录深度</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find / -maxdepth 3 -a -name &quot;ifcfg-ens33&quot; # 最大查找深度<br><span class="hljs-meta prompt_"># </span><span class="language-bash">-a是同时满足，-o是或</span><br>[root@localhost ~]# find / -mindepth 3 -a -name &quot;ifcfg-ens33&quot; # 最小查找深度<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>按时间找</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find /etc -mtime +5 # 修改时间超过5天<br>[root@localhost ~]# find /etc -mtime 5 # 修改时间等于5天<br>[root@localhost ~]# find /etc -mtime -5 # 修改时间5天以内<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>按照文件属主、属组找</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find /home -user xwz # 属主是xwz的文件<br>[root@localhost ~]# find /home -group xwz<br>[root@localhost ~]# find /home -user xwz -group xwz<br>[root@localhost ~]# find /home -user xwz -a -group root<br>[root@localhost ~]# find /home -user xwz -o -group root<br>[root@localhost ~]# find /home -nouser # 没有属主的文件<br>[root@localhost ~]# find /home -nogroup # 没有属组的文件<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>按文件类型</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find /dev -type d<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>按文件权限</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find / -perm 644 -ls<br>[root@localhost ~]# find / -perm -644 -ls # 权限小于644的<br>[root@localhost ~]# find / -perm 4000 -ls<br>[root@localhost ~]# find / -perm -4000 -ls<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>按正则表达式</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# find /etc -regex &#x27;.*ifcfg-ens[0-9][0-9]&#x27;<br><span class="hljs-meta prompt_"># </span><span class="language-bash">.* 任意多个字符</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">[0-9] 任意一个数字</span><br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>条件组合</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">-a：多个条件and并列<br>-o：多个条件or并列<br>-not：条件取反<br></code></pre></td></tr></table></figure><h2 id="处理动作">处理动作</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">‐print：默认的处理动作，显示至屏幕<br>‐ls：类型于对查找到的文件执行“ls ‐l”命令<br>‐delete：删除查找到的文件<br>‐fls /path/to/somefile：查找到的所有文件的长格式信息保存至指定文件中<br>‐ok COMMAND &#123;&#125;\：对查找到的每个文件执行由COMMAND指定的命令<br>对于每个文件执行命令之前，都会交换式要求用户确认<br>‐exec COMMAND &#123;&#125; \：对查找到的每个文件执行由COMMAND指定的命令<br>[root@server1 ~]# find /etc/init.d/ -perm -111 -exec cp -r &#123;&#125; dir1/ \;<br>&#123;&#125;：用于引用查找到的文件名称自身<br>注意：find传递查找到的文件至后面指定的命令时，查找到所有符合条件的文件一次性传递给后面的命<br>令；另一种方式可规避此问题<br>find | xargs COMMAND<br></code></pre></td></tr></table></figure><h1>正则表达式</h1><p>正则表达式是用来匹配字符串的，针对文件内容的文本过滤工具里，大都用到正则表达式，如vi， grep，awk， sed等</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#字符匹配</span></span><br>    .：匹配任意单个字符<br>    []：匹配指定范围内任意单个字符 [a-z] [0-9]<br>    [^]：匹配指定范围外任意单个字符 [^a-z] [^0-9]<br>    [:alnum:]：字母与数字字符<br>    [:alpha:]：字母<br>    [:ascii:]：ASCII字符<br>    [:blank:]：空格或制表符<br>    [:cntrl:]：ASCII控制字符<br>    [:digit:]：数字<br>    [:graph:]：非控制、非空格字符<br>    [:lower:]：小写字母<br>    [:print:]：可打印字符<br>    [:punct:]：标点符号字符<br>    [:space:]：空白字符，包括垂直制表符<br>    [:upper:]：大写字母<br>    [:xdigit:]：十六进制数字<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#匹配次数</span></span><br>    *：匹配前面的字符任意次数<br>    .*：匹配任意长度的字符<br>    \?：匹配其前面字符0或1次，即前面的可有可无 &#x27;a\?b&#x27;<br>    \+：匹配其前面的字符至少1次 &#x27;a\+b&#x27;<br>    \&#123;m\&#125;：匹配前面的字符m次<br>    \&#123;m,n\&#125;：匹配前面的字符至少m次，至多n次<br>    \&#123;0,n\&#125;：匹配前面的字符至多n次<br>    \&#123;m,\&#125;：匹配前面的字符至少m次<br>    ##位置锚定<br>    ^：行首锚定，用于模式的最左侧<br>    $：行末锚定，用于模式的最右侧<br>    ^PATTERN$：用于模式匹配整行；<br>    ^$：空行<br>    \&lt; 或 \b：词首锚定，用于单词模式的左侧<br>    \&gt; 或 \b：词尾锚定，用于单词模式的右侧<br>    \&lt;PATTERN\&gt;：匹配整个单词 &#x27;\&lt;hello\&gt;&#x27;<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#分组</span></span><br>	\(\):将一个或多个字符捆绑在一起；当作一个字符<br>	\(xy\)*ab<br>	Note：分组括号中的模式匹配到的内容会被正则表达式引擎记录于内部的变量中，这些变量的命令<br>方式为：<br>    \1，\2，\3……<br>    \1：从左侧起，第一个左括号以及与之匹配右括号之间的模式所匹配到的字符；<br>    \(ab\+\(xy\)*\):<br>    \1：ab\+\(xy\)*<br>    \2：xy<br></code></pre></td></tr></table></figure><ul class="lvl-0"><li class="lvl-2"><p>扩展正则表达式</p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#字符匹配</span></span><br>.<br>[]<br>[^]<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#次数匹配</span></span><br>*<br>？：0次或1次<br>+：1次或多次<br>&#123;m&#125;:匹配m次<br>&#123;m,n&#125;：至少m次，至多n次<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#位置锚定</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#分组</span></span><br>()<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">#或者</span></span><br>a|b<br>C | cat ：C或cat<br>(C|c)at : C或c<br></code></pre></td></tr></table></figure><h1>Linux三剑客之grep</h1><p>grep作用：过滤文本内容</p><table><thead><tr><th>选项</th><th>描述</th></tr></thead><tbody><tr><td>-E :–extended–regexp</td><td>模式是扩展正则表达式（ERE）</td></tr><tr><td>-i :–ignore–case</td><td>忽略大小写</td></tr><tr><td>-n: --line–number</td><td>打印行号</td></tr><tr><td>-o:–only–matching</td><td>只打印匹配的内容</td></tr><tr><td>-c:–count</td><td>只打印每个文件匹配的行数</td></tr><tr><td>-B:–before–context=NUM</td><td>打印匹配的前几行</td></tr><tr><td>-A:–after–context=NUM</td><td>打印匹配的后几行</td></tr><tr><td>-C:–context=NUM</td><td>打印匹配的前后几行</td></tr><tr><td>–color[=WHEN]</td><td>匹配的字体颜色，别名已定义了</td></tr><tr><td>-v:–invert–match</td><td>打印不匹配的行</td></tr><tr><td>-e</td><td>多点操作eg：grep -e “^s” -e “s$”</td></tr></tbody></table><p>样本文件内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# cat test<br>asdkahsduoa<br>aslkdsl<br>oiofr<br>sdjo<br>A<br>F<br>aSDD<br>CASDC<br><br>asdo<br>ca<br></code></pre></td></tr></table></figure><h2 id="实例">实例</h2><p>实例1：打印出所有的a无论大小写 ： -i选项</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -i &quot;a&quot; test<br>asdkahsduoa<br>aslkdsl<br>A<br>aSDD<br>CASDC<br>asdo<br>ca<br></code></pre></td></tr></table></figure><p>实例2：打印出所有的a无论大小写，并且显示该字符串所在的行 ： -n选项</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -in &quot;a&quot; test<br>1:asdkahsduoa<br>2:aslkdsl<br>5:A<br>7:aSDD<br>8:CASDC<br>10:asdo<br>11:ca<br></code></pre></td></tr></table></figure><p>实例3：仅仅打印出所有匹配的字符串： -o选项</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -io &quot;a&quot; test<br>a<br>a<br>a<br>a<br>A<br>a<br>A<br>a<br>a<br></code></pre></td></tr></table></figure><p>实例4：打印出匹配的字符串有多少行 -c选项</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -ic &quot;a&quot; test<br>7<br></code></pre></td></tr></table></figure><p>实例5：打印出字符S前面的2行 -B</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -B 2 &quot;S&quot; test<br>A<br>F<br>aSDD<br>CASDC<br></code></pre></td></tr></table></figure><p>实例6：打印出字符S后面的2行 -A</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -A 2 &quot;S&quot; test<br>aSDD<br>CASDC<br><br>asdo<br></code></pre></td></tr></table></figure><p>实例7：打印出字符S前后2行 -C</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -C 2 &quot;S&quot; test<br>A<br>F<br>aSDD<br>CASDC<br><br>asdo<br><br></code></pre></td></tr></table></figure><p>实例8：打印出不包含大小s的所有行 取反 -v</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -iv &quot;S&quot; test<br>oiofr<br>A<br>F<br><br>ca<br></code></pre></td></tr></table></figure><p>grep可以从文件当中直接搜索某个关键词,也可以从标准输入里面搜索</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep root /etc/passwd<br>root:x:0:0:root:/root:/bin/bash<br>operator:x:11:0:operator:/root:/sbin/nologin<br>[root@localhost ~]# cat /etc/passwd | grep &quot;root&quot;<br>root:x:0:0:root:/root:/bin/bash<br>operator:x:11:0:operator:/root:/sbin/nologin<br></code></pre></td></tr></table></figure><h2 id="正则表达式（基于grep）">正则表达式（基于grep）</h2><ul class="lvl-0"><li class="lvl-2"><p>功能就是用来检索、替换那些符合某个模式(规则)的文本,正则表达式在每种语言中都会有;</p></li><li class="lvl-2"><p>正则表达式就是为了处理大量的文本或字符串而定义的一套规则和方法</p></li><li class="lvl-2"><p>通过定义的这些特殊符号的辅助，系统管理员就可以快速过滤，替换或输出需要的字符串</p></li><li class="lvl-2"><p>Linux正则表达式一般以行为单位处理</p></li></ul><h3 id="基础正则表达式">基础正则表达式</h3><table><thead><tr><th>符号</th><th>描述</th></tr></thead><tbody><tr><td>.</td><td>匹配任意单个字符（必须存在）</td></tr><tr><td>^</td><td>匹配以某个字符开头的行</td></tr><tr><td>$</td><td>配以什么字符结尾的行</td></tr><tr><td>*</td><td>匹配前面的一个字符出现0次或者多次；eg：a*b</td></tr><tr><td>.*</td><td>表示任意长度的任意字符</td></tr><tr><td>[]</td><td>表示匹配括号内的一个字符</td></tr><tr><td>[^]</td><td>匹配<code>[^字符]</code>之外的任意一个字符</td></tr><tr><td>[]</td><td>匹配非<code>[^字符]</code>内字符开头的行</td></tr><tr><td>&lt;</td><td>锚定 单词首部；eg：\</td></tr><tr><td>&gt;</td><td>锚定 单词尾部：eg：root&gt;</td></tr><tr><td>{m,n}</td><td>表示匹配前面的字符出现至少m次，至多n次</td></tr><tr><td>()</td><td>表示对某个单词进行分组；\1表示第一个分组进行调用</td></tr></tbody></table><h3 id="扩展正则">扩展正则</h3><ul class="lvl-0"><li class="lvl-2"><p>egrep …</p></li><li class="lvl-2"><p>grep -E …</p></li><li class="lvl-2"><p>扩展正则支持所有基础正则；</p></li><li class="lvl-2"><p>并有补充 扩展正则中{}和[]不用转义可以直接使用；</p></li></ul><table><thead><tr><th>符号</th><th>描述</th></tr></thead><tbody><tr><td>+</td><td>表示前面的字符至少出现1次的情况</td></tr><tr><td>|</td><td>表示“或”</td></tr><tr><td>？</td><td>表示前面的字符至多出现1次的情况</td></tr></tbody></table><h3 id="最常用">最常用</h3><p>查看配置文件时去除所有的注释和空行</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@localhost ~]# grep -Ev &quot;^#|^$&quot; /etc/ssh/sshd_config<br></code></pre></td></tr></table></figure><h1>Linux三剑客之sed</h1><p>Linux sed命令是利用script来处理文本文件。</p><p>sed可依照script的指令，来处理、编辑文本文件。</p><p>sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。</p><h2 id="语法">语法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">sed的命令格式： sed [option] <span class="hljs-string">&#x27;sed command&#x27;</span> filename<br>sed的脚本格式：sed [option] ‐f <span class="hljs-string">&#x27;sed script&#x27;</span> filename<br>常用选项：<br>‐n ：只打印模式匹配的行<br>‐e ：直接在命令行模式上进行sed动作编辑，此为默认选项<br>‐f ：将sed的动作写在一个文件内，用–f filename 执行filename内的sed动作<br>‐r ：支持扩展表达式<br>‐i ：直接修改文件内容<br>查询文本的方式<br>使用行号和行号范围<br>x：行号<br>x,y：从x行到y行<br>x,y!：x行到y行之外<br>/pattern：查询包含模式的行<br>/pattern/, /pattern/：查询包含两个模式的行<br>/pattern/,x：x行内查询包含模式的行<br>x,/pattern/：x行后查询匹配模式的行<br></code></pre></td></tr></table></figure><h2 id="动作说明">动作说明</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">常用选项：<br>p：打印匹配的行(‐n)<br>=：显示文件行号<br>a\：指定行号后添加新文本<br>i\：指定行号前添加新文本<br>d：删除定位行<br>c\：用新文本替换定位文本<br>w filename：写文本到一个文件<br>r filename：从另一个文件读文本<br>s///：替换<br>替换标记：<br>g：行内全局替换<br>p：显示替换成功的行<br>w：将替换成功的结果保存至指定文件<br>q：第一个模式匹配后立即退出<br>&#123;&#125;：在定位行执行的命令组，用逗号分隔<br>g：将模式2粘贴到/pattern n/<br></code></pre></td></tr></table></figure><p>a ：新增， a 的后面可以接字串，而这些字串会在新的一行出现(目前的下一行)</p><p>c ：取代， c 的后面可以接字串，这些字串可以取代 n1,n2 之间的行！</p><p>d ：删除，因为是删除啊，所以 d 后面通常不接任何东西；</p><p>i ：插入， i的后面可以接字串，而这些字串会在新的一行出现(目前的上一行)；</p><p>p ：打印，亦即将某个选择的数据印出。通常 p 会与参数 sed -n 一起运行</p><p>s ：取代，可以直接进行取代的工作哩！通常这个 s 的动作可以搭配正规表示法！例如 1,20s/old/new/g 就是啦！</p><h2 id="实例-2">实例</h2><p>在testfile文件的第四行后添加一行，并将结果输出到标准输出</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@localhost ~]# sed -<span class="hljs-keyword">e</span> 4a\newline <span class="hljs-keyword">test</span><br><span class="hljs-keyword">line</span> <span class="hljs-keyword">one</span><br><span class="hljs-keyword">line</span> <span class="hljs-keyword">two</span><br><span class="hljs-keyword">line</span> three<br><span class="hljs-keyword">line</span> four<br>newline<br><span class="hljs-keyword">line</span> five<br></code></pre></td></tr></table></figure><h3 id="以行为单位的新增-删除">以行为单位的新增/删除</h3><p>将 /etc/passwd 的内容列出并且列印行号，同时，请将第 2~5 行删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;2,5d&#x27;</span><br>    1 root:x:0:0:root:/root:/bin/bash<br>    6 <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br>    8 halt:x:7:0:halt:/sbin:/sbin/halt<br>    9 mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br>    10 operator:x:11:0:operator:/root:/sbin/nologin<br>    11 games:x:12:100:games:/usr/games:/sbin/nologin<br>    12 ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>    13 nobody:x:99:99:Nobody:/:/sbin/nologin<br>    14 systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin<br>    15 dbus:x:81:81:System message bus:/:/sbin/nologin<br>    16 polkitd:x:999:998:User <span class="hljs-keyword">for</span> polkitd:/:/sbin/nologin<br>    17 sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br>    18 postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br></code></pre></td></tr></table></figure><p>sed 的动作为 ‘2,5d’ ，那个 d 就是删除！因为 2-5 行给他删除了，所以显示的数据就没有 2-5 行罗～ 另 外，注意一下，原本应该是要下达 sed -e 才对，没有 -e 也行啦！同时也要注意的是， sed 后面接的动 作，请务必以 ‘’ 两个单引号括住喔！</p><p>只要删除第 2 行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;2d&#x27;</span><br>    1 root:x:0:0:root:/root:/bin/bash<br>    3 daemon:x:2:2:daemon:/sbin:/sbin/nologin<br>    4 adm:x:3:4:adm:/var/adm:/sbin/nologin<br>    5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br>    6 <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br>    8 halt:x:7:0:halt:/sbin:/sbin/halt<br>    9 mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br>    10 operator:x:11:0:operator:/root:/sbin/nologin<br>    11 games:x:12:100:games:/usr/games:/sbin/nologin<br>    12 ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>    13 nobody:x:99:99:Nobody:/:/sbin/nologin<br>    14 systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin<br>    15 dbus:x:81:81:System message bus:/:/sbin/nologin<br>    16 polkitd:x:999:998:User <span class="hljs-keyword">for</span> polkitd:/:/sbin/nologin<br>    17 sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br>	18 postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br></code></pre></td></tr></table></figure><p>要删除第 3 到最后一行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;3,$d&#x27;</span><br>    1 root:x:0:0:root:/root:/bin/bash<br>    2 bin:x:1:1:bin:/bin:/sbin/nologin<br></code></pre></td></tr></table></figure><p>在第二行后(亦即是加在第三行)加上『hello world』字样</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;2a\hello world&#x27;</span><br>    1 root:x:0:0:root:/root:/bin/bash<br>    2 bin:x:1:1:bin:/bin:/sbin/nologin<br>hello world<br>    3 daemon:x:2:2:daemon:/sbin:/sbin/nologin<br>    4 adm:x:3:4:adm:/var/adm:/sbin/nologin<br>    5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br>    6 <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br>    8 halt:x:7:0:halt:/sbin:/sbin/halt<br>    9 mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br>    10 operator:x:11:0:operator:/root:/sbin/nologin<br>    11 games:x:12:100:games:/usr/games:/sbin/nologin<br>    12 ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>    13 nobody:x:99:99:Nobody:/:/sbin/nologin<br>    14 systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin<br>    15 dbus:x:81:81:System message bus:/:/sbin/nologin<br>    16 polkitd:x:999:998:User <span class="hljs-keyword">for</span> polkitd:/:/sbin/nologin<br>    17 sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br>    18 postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br></code></pre></td></tr></table></figure><p>加在第二行前面</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;2i\hello world&#x27;</span><br>	1 root:x:0:0:root:/root:/bin/bash<br>hello world<br>    2 bin:x:1:1:bin:/bin:/sbin/nologin<br>    3 daemon:x:2:2:daemon:/sbin:/sbin/nologin<br>    4 adm:x:3:4:adm:/var/adm:/sbin/nologin<br>    5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br>    6 <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br>    8 halt:x:7:0:halt:/sbin:/sbin/halt<br>    9 mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br>    10 operator:x:11:0:operator:/root:/sbin/nologin<br>    11 games:x:12:100:games:/usr/games:/sbin/nologin<br>    12 ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>    13 nobody:x:99:99:Nobody:/:/sbin/nologin<br>    14 systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin<br>    15 dbus:x:81:81:System message bus:/:/sbin/nologin<br>    16 polkitd:x:999:998:User <span class="hljs-keyword">for</span> polkitd:/:/sbin/nologin<br>    17 sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br>    18 postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br></code></pre></td></tr></table></figure><p>增加多行文字</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;2a\hello world\</span><br>&gt; nihao<span class="hljs-string">&#x27;</span><br><span class="hljs-string">    1 root:x:0:0:root:/root:/bin/bash</span><br><span class="hljs-string">    2 bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="hljs-string">hello world</span><br><span class="hljs-string">nihao</span><br><span class="hljs-string">    3 daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="hljs-string">    4 adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="hljs-string">    5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="hljs-string">    6 sync:x:5:0:sync:/sbin:/bin/sync</span><br><span class="hljs-string">    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="hljs-string">    8 halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="hljs-string">    9 mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="hljs-string">    10 operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="hljs-string">    11 games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="hljs-string">    12 ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="hljs-string">    13 nobody:x:99:99:Nobody:/:/sbin/nologin</span><br><span class="hljs-string">    14 systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin</span><br><span class="hljs-string">    15 dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="hljs-string">    16 polkitd:x:999:998:User for polkitd:/:/sbin/nologin</span><br><span class="hljs-string">    17 sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="hljs-string">    18 postfix:x:89:89::/var/spool/postfix:/sbin/nologin</span><br></code></pre></td></tr></table></figure><h3 id="以行为单位的替换与显示">以行为单位的替换与显示</h3><p>将第2-5行的内容取代成为『No 2-5 number』</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;2,5c\No 2-5 number&#x27;</span><br>	1 root:x:0:0:root:/root:/bin/bash<br>No 2-5 number<br>    6 <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br>    8 halt:x:7:0:halt:/sbin:/sbin/halt<br>    9 mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br>    10 operator:x:11:0:operator:/root:/sbin/nologin<br>    11 games:x:12:100:games:/usr/games:/sbin/nologin<br>    12 ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>    13 nobody:x:99:99:Nobody:/:/sbin/nologin<br>    14 systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin<br>    15 dbus:x:81:81:System message bus:/:/sbin/nologin<br>    16 polkitd:x:999:998:User <span class="hljs-keyword">for</span> polkitd:/:/sbin/nologin<br>    17 sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br>    18 postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br></code></pre></td></tr></table></figure><p>仅列出 /etc/passwd 文件内的第 5-7 行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed -n &#x27;5,7p&#x27;</span><br>    5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br>    6 <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br></code></pre></td></tr></table></figure><h3 id="数据的搜寻并显示">数据的搜寻并显示</h3><p>搜索 /etc/passwd有root关键字的行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed -n &#x27;/root/p&#x27;</span><br>    1 root:x:0:0:root:/root:/bin/bash<br>    10 operator:x:11:0:operator:/root:/sbin/nologin<br></code></pre></td></tr></table></figure><h3 id="数据的搜寻并删除">数据的搜寻并删除</h3><p>删除/etc/passwd所有包含root的行，其他行输出</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed &#x27;/root/d&#x27;</span><br>    2 bin:x:1:1:bin:/bin:/sbin/nologin<br>    3 daemon:x:2:2:daemon:/sbin:/sbin/nologin<br>    4 adm:x:3:4:adm:/var/adm:/sbin/nologin<br>    5 lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br>    6 <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>    7 shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br>    8 halt:x:7:0:halt:/sbin:/sbin/halt<br>    9 mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br>    11 games:x:12:100:games:/usr/games:/sbin/nologin<br>    12 ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>    13 nobody:x:99:99:Nobody:/:/sbin/nologin<br>    14 systemd-network:x:192:192:systemd Network Management:/:/sbin/nologin<br>    15 dbus:x:81:81:System message bus:/:/sbin/nologin<br>    16 polkitd:x:999:998:User <span class="hljs-keyword">for</span> polkitd:/:/sbin/nologin<br>    17 sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br>    18 postfix:x:89:89::/var/spool/postfix:/sbin/nologin<br></code></pre></td></tr></table></figure><h3 id="数据的搜寻并执行命令">数据的搜寻并执行命令</h3><p>搜索/etc/passwd,找到root对应的行，执行后面花括号中的一组命令，每个命令之间用分号分隔，这里 把bash替换为blueshell，再输出这行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed -n &#x27;/root/&#123;s/bash/blueshell/p;q&#125;&#x27;</span><br>	1 root:x:0:0:root:/root:/bin/blueshell<br></code></pre></td></tr></table></figure><p>最后的q是退出，不然会继续找下去</p><h3 id="数据的搜寻并替换">数据的搜寻并替换</h3><p>除了整行的处理模式之外， sed 还可以用行为单位进行部分数据的搜寻并取代</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sed <span class="hljs-string">&#x27;s/要被取代的字串/新的字串/g&#x27;</span><br></code></pre></td></tr></table></figure><p>查询 IP</p><p>原始信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># ifconfig</span><br>ens33: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500<br>        inet 192.168.91.128 netmask 255.255.255.0 broadcast 192.168.91.255<br>        inet6 fe80::2de4:b37a:36e9:ae2e prefixlen 64 scopeid 0x20&lt;<span class="hljs-built_in">link</span>&gt;<br>        ether 00:0c:29:d3:76:83 txqueuelen 1000 (Ethernet)<br>        RX packets 33461 bytes 32133707 (30.6 MiB)<br>        RX errors 0 dropped 0 overruns 0 frame 0<br>        TX packets 11322 bytes 1300148 (1.2 MiB)<br>        TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br><br>lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt; mtu 65536<br>        inet 127.0.0.1 netmask 255.0.0.0<br>        inet6 ::1 prefixlen 128 scopeid 0x10&lt;host&gt;<br>        loop txqueuelen 1000 (Local Loopback)<br>        RX packets 10 bytes 697 (697.0 B)<br>        RX errors 0 dropped 0 overruns 0 frame 0<br>        TX packets 10 bytes 697 (697.0 B)<br>        TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0<br></code></pre></td></tr></table></figure><p>取有IP地址那一行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># ifconfig | sed -n &#x27;/netmask/p&#x27;</span><br>    inet 192.168.91.128 netmask 255.255.255.0 broadcast 192.168.91.255<br>    inet 127.0.0.1 netmask 255.0.0.0<br></code></pre></td></tr></table></figure><p>删除IP地址前面和后面的东西</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># ifconfig | sed -n &#x27;/netmask/p&#x27; | sed &#x27;s/^.*inet //g&#x27; |</span><br>sed <span class="hljs-string">&#x27;s/ netmask.*$//g&#x27;</span><br>192.168.91.128<br>127.0.0.1<br></code></pre></td></tr></table></figure><p>取第一行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># ifconfig | sed -n &#x27;/netmask/p&#x27; | sed &#x27;s/^.*inet //g&#x27; |</span><br>sed <span class="hljs-string">&#x27;s/ netmask.*$//g&#x27;</span> | sed -n <span class="hljs-string">&#x27;1p&#x27;</span><br>192.168.91.128<br></code></pre></td></tr></table></figure><p>可以在末尾加g替换每一个匹配的关键字,否则只替换每行的第一个</p><p>另一种方式：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span> ~]<span class="hljs-meta"># ip a|sed -n <span class="hljs-string">&#x27;/inet /p&#x27;</span>|sed <span class="hljs-string">&#x27;s/^.*inet //g&#x27;</span>|sed<span class="hljs-string">&#x27;s/\/.*$//g&#x27;</span>|sed -n <span class="hljs-string">&#x27;2p</span></span><br></code></pre></td></tr></table></figure><h2 id="多点编辑">多点编辑</h2><p>一条sed命令，删除/etc/passwd第三行到末尾的数据，并把bash替换为blueshell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># nl /etc/passwd | sed -e &#x27;3,$d&#x27; -e &#x27;s/bash/blueshell/&#x27;</span><br>    1 root:x:0:0:root:/root:/bin/blueshell<br>    2 bin:x:1:1:bin:/bin:/sbin/nologin<br></code></pre></td></tr></table></figure><p>-e表示多点编辑，第一个编辑命令删除/etc/passwd第三行到末尾的数据，第二条命令搜索bash替换为 blueshell。</p><h2 id="直接修改文件内容-危险动作">直接修改文件内容(危险动作)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># cat test</span><br>line one.<br>line two.<br>line three.<br>line four.<br>line five.<br></code></pre></td></tr></table></figure><p>加i参数就是直接修改</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># sed -i &#x27;s/\.$/\!/g&#x27; test</span><br>[root@localhost ~]<span class="hljs-comment"># cat test</span><br>line one!<br>line two!<br>line three!<br>line four!<br>line five!<br></code></pre></td></tr></table></figure><p>利用 sed 直接在最后一行加入 # test</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># sed -i &#x27;$a\# test&#x27; test</span><br>[root@localhost ~]<span class="hljs-comment"># cat test</span><br>line one!<br>line two!<br>line three!<br>line four!<br>line five!<br><span class="hljs-comment"># test</span><br></code></pre></td></tr></table></figure><h1>Linux三剑客之awk</h1><h2 id="使用方法">使用方法</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">awk <span class="hljs-string">&#x27;&#123;pattern + action&#125;&#x27;</span> &#123;filenames&#125;<br></code></pre></td></tr></table></figure><p>其中 pattern 表示 AWK 在数据中查找的内容，而 action 是在找到匹配内容时所执行的一系列命令。花 括号（{}）不需要在程序中始终出现，但它们用于根据特定的模式对一系列指令进行分组。 pattern就是 要表示的正则表达式，用斜杠括起来。</p><p>awk语言的最基本功能是在文件或者字符串中基于指定规则浏览和抽取信息，awk抽取信息后，才能进 行其他文本操作。完整的awk脚本通常用来格式化文本文件中的信息。</p><p>通常，awk是以文件的一行为处理单位的。awk每接收文件的一行，然后执行相应的命令，来处理文 本。</p><h2 id="awk-的原理">awk 的原理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># awk -F: &#x27;&#123;print $0&#125;&#x27; /etc/passwd</span><br></code></pre></td></tr></table></figure><p>执行 awk 时，它依次对/etc/passwd 中的每一行执行 print 命令</p><p><img src="image-20220812090844760.png" srcset="/img/loading.gif" lazyload alt=""></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># awk -F&quot;:&quot; &#x27;&#123;print $1&#125;&#x27; /etc/passwd</span><br>[root@localhost ~]<span class="hljs-comment"># awk -F&quot;:&quot; &#x27;&#123;print $1 $3&#125;&#x27; /etc/passwd</span><br>[root@localhost ~]<span class="hljs-comment"># awk -F&quot;:&quot; &#x27;&#123;print $1&quot; &quot; $3&#125;&#x27; /etc/passwd</span><br>[root@localhost ~]<span class="hljs-comment"># awk -F&quot;:&quot; &#x27;&#123;print &quot;username:&quot;$1&quot;\t\tuid:&quot; $3&#125;&#x27;/etc/passwd</span><br></code></pre></td></tr></table></figure><p>-F参数：指定分隔符，可指定一个或多个</p><p>print 后面做字符串的拼接</p><h2 id="实例一：只查看test-txt文件（100行）内第20到第30行的内容（企业面试）">实例一：只查看test.txt文件（100行）内第20到第30行的内容（企业面试）</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># seq 100 &gt; test.txt</span><br>[root@localhost ~]<span class="hljs-comment"># awk &#x27;&#123;if(NR&gt;=20 &amp;&amp; NR&lt;=30) print $1&#125;&#x27; test.txt</span><br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br></code></pre></td></tr></table></figure><h2 id="实例二：已知test-txt文件内容为">实例二：已知test.txt文件内容为</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># cat test.txt</span><br>I am aaron, my qq is 1234567<br></code></pre></td></tr></table></figure><p>请从该文件中过滤出’aaron’字符串与1234567，最后输出的结果为：aaron 1234567</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># awk -F &#x27;[ ,]+&#x27; &#x27;&#123;print $3&quot; &quot;$8&#125;&#x27; test.txt #用[]可以放多个分隔符</span><br>aaron 1234567<br>等效<br>[root@localhost ~]<span class="hljs-comment"># awk -F &#x27;,&#x27; &#x27;&#123;print $1&quot; &quot;$2&#125;&#x27; test.txt|awk &#x27;&#123;print $3 &quot; &quot;$7&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="BEGIN-和-END-模块">BEGIN 和 END 模块</h2><h3 id="实例一：统计-etc-passwd的账户人数">实例一：统计/etc/passwd的账户人数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">awk <span class="hljs-string">&#x27;BEGIN &#123;count=0;print &quot;[start] user count is &quot;,count&#125;&#123;count++;print $0&#125;END&#123;print &quot;[end] user count is &quot;,count&#125;&#x27;</span> /etc/passwd<br></code></pre></td></tr></table></figure><p>count是自定义变量。之前的action{}里都是只有一个print,其实print只是一个语句，而action{}可以有多 个语句，以;号隔开。这里没有初始化count，虽然默认是0，但是妥当的做法还是初始化为0</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># awk &#x27;&#123;count++;print $0;&#125; END&#123;print &quot;user count is&quot;,count&#125;&#x27; /etc/passwd</span><br></code></pre></td></tr></table></figure><h3 id="实例二：统计某个文件夹下的文件占用的字节数">实例二：统计某个文件夹下的文件占用的字节数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># ll | awk &#x27;BEGIN &#123;size=0&#125; &#123;size=size+$5&#125; END&#123;print &quot;sizeis &quot;,size&#125;&#x27;</span><br>size is 1468<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@localhost ~]<span class="hljs-comment"># ll | awk &#x27;BEGIN &#123;size=0&#125; &#123;size=size+$5&#125; END&#123;print&quot;sizeis&quot;,size/1024/1024,&quot;M&quot;&#125;&#x27;</span><br>size is 0.00139999 M<br></code></pre></td></tr></table></figure><h2 id="awk运算符">awk运算符</h2><table><thead><tr><th>运算符</th><th>描述</th></tr></thead><tbody><tr><td>赋值运算符</td><td></td></tr><tr><td>= += -= *= /= %= ^= **=</td><td>赋值语句</td></tr><tr><td>逻辑运算符</td><td></td></tr><tr><td>||</td><td>逻辑或</td></tr><tr><td>&amp;&amp;</td><td>逻辑与</td></tr><tr><td>正则运算符</td><td></td></tr><tr><td>~ !~</td><td>匹配正则表达式和不匹配正则表达式</td></tr><tr><td>关系运算符</td><td></td></tr><tr><td>&lt; &lt;= &gt; &gt;= != ==</td><td>关系运算符</td></tr><tr><td>算数运算符</td><td></td></tr><tr><td>+ -</td><td>加,减</td></tr><tr><td>* / &amp;</td><td>乘,除与求余</td></tr><tr><td>+ - !</td><td>一元加,减和逻辑非</td></tr><tr><td>^ ***</td><td>求幂</td></tr><tr><td>++ –</td><td>增加或减少，作为前缀或后缀</td></tr><tr><td>其他运算符</td><td></td></tr><tr><td>$</td><td>字段引用</td></tr><tr><td>空格</td><td>字符串链接符</td></tr><tr><td>?:</td><td>三目运算符</td></tr><tr><td>ln</td><td>数组中是否存在某键值</td></tr></tbody></table><p>awk 赋值运算符：a+=5;等价于： a=a+5;其他同类</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=5;a+=5;print a&#125;&#x27;</span><br>10<br></code></pre></td></tr></table></figure><p>awk逻辑运算符：判断表达式 a&gt;2&amp;&amp;b&gt;1为真还是为假，后面的表达式同理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=1;b=2;print (a&gt;2&amp;&amp;b&gt;1,a=1||b&gt;1)&#125;&#x27;</span><br>0 1<br></code></pre></td></tr></table></figure><p>awk正则运算符：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=&quot;100testaa&quot;;if(a~/100/) &#123;print &quot;OK&quot;&#125;&#125;&#x27;</span><br>OK<br></code></pre></td></tr></table></figure><p>关系运算符：</p><p>如： &gt; &lt; 可以作为字符串比较，也可以用作数值比较，关键看操作数如果是字符串就会转换为字符串比 较。两个都为数字 才转为数值比较。字符串比较：按照ascii码顺序比较。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=&quot;11&quot;;if(a&gt;=9)&#123;print&quot;OK&quot;&#125;&#125;&#x27;</span><br>[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=11;if(a&gt;=9)&#123;print&quot;OK&quot;&#125;&#125;&#x27;</span><br>OK<br>[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a;if(a&gt;=b)&#123;print&quot;OK&quot;&#125;&#125;&#x27;</span><br>OK<br></code></pre></td></tr></table></figure><p>awk 算术运算符：</p><p>说明，所有用作算术运算符进行操作，操作数自动转为数值，所有非数值都变为0。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=&quot;b&quot;;print a++,++a&#125;&#x27;</span><br>0 2<br>[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=&quot;20b4&quot;;print a++,++a&#125;&#x27;</span><br>20 22<br></code></pre></td></tr></table></figure><p>这里的a++ , <ins>a与javascript语言一样：a</ins>是先赋值加++；<ins>a是先</ins>再赋值</p><p>三目运算符 ?:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=&quot;b&quot;;print a==&quot;b&quot;?&quot;ok&quot;:&quot;err&quot;&#125;&#x27;</span><br>ok<br>[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;a=&quot;b&quot;;print a==&quot;c&quot;?&quot;ok&quot;:&quot;err&quot;&#125;&#x27;</span><br>err<br></code></pre></td></tr></table></figure><h2 id="常用-awk-内置变量">常用 awk 内置变量</h2><table><thead><tr><th>变量名</th><th>属性</th></tr></thead><tbody><tr><td>$0</td><td>当前记录</td></tr><tr><td>1 n</td><td>当前记录的第n个字段</td></tr><tr><td>FS</td><td>输入字段分割符 默认是空格</td></tr><tr><td>RS</td><td>输入记录分割符 默认为换行符</td></tr><tr><td>NF</td><td>当前记录中的字段个数，就是有多少列</td></tr><tr><td>NR</td><td>已经读出的记录数，就是行号，从1开始</td></tr><tr><td>OFS</td><td>输出字段分割符 默认也是空格</td></tr><tr><td>ORS</td><td>输出的记录分割符 默认为换行符</td></tr></tbody></table><p>注：内置变量很多，参阅相关资料</p><p>字段分隔符 FS</p><p>FS=“\t” 一个或多个 Tab 分隔</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># cat tab.txt</span><br>aa bb cc<br>[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;FS=&quot;\t+&quot;&#125;&#123;print $1,$2,$3&#125;&#x27; tab.txt</span><br>aa bb cc<br></code></pre></td></tr></table></figure><p>FS=“[[:space:]+]” 一个或多个空白空格，默认的，匹配到不符合的就停止</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk -F [[:space:]+] &#x27;&#123;print $1,$2,$3,$4,$5&#125;&#x27; tab.txt</span><br>aa bb cc<br>[root@node-1 ~]<span class="hljs-comment"># awk -F [[:space:]+] &#x27;&#123;print $1,$2&#125;&#x27; tab.txt</span><br>aa bb<br></code></pre></td></tr></table></figure><p>FS=“[” “:]+” 以一个或多个空格或：分隔</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk -F [&quot; &quot;:]+ &#x27;&#123;print $1,$2,$3&#125;&#x27; hello.txt</span><br>root x 0<br></code></pre></td></tr></table></figure><p>字段数量 NF :显示满足用:分割，并且有8个字段的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk -F &quot;:&quot; &#x27;NF==8&#123;print $0&#125;&#x27; hello.txt</span><br>bin:x:1:1:bin:/bin:/sbin/nologin:888<br></code></pre></td></tr></table></figure><p>记录数量 NR</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># ifconfig br0 | awk -F [&quot; &quot;:]+ &#x27;NR==2&#123;print $3&#125;&#x27;</span><br>192.168.0.241<br></code></pre></td></tr></table></figure><p>RS 记录分隔符变量</p><p>将 FS 设置成&quot;\n&quot;告诉 awk 每个字段都占据一行。通过将 RS 设置成&quot;&quot;，还会告诉 awk每个地址记录都由 空白行分隔。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># cat awk.txt</span><br><span class="hljs-comment">#!/bin/awk</span><br>BEGIN &#123;<br>FS=<span class="hljs-string">&quot;\n&quot;</span><br>RS=<span class="hljs-string">&quot;&quot;</span><br>&#125;<br>&#123;<br><span class="hljs-built_in">print</span> <span class="hljs-variable">$1</span><span class="hljs-string">&quot;,&quot;</span><span class="hljs-variable">$2</span><span class="hljs-string">&quot;,&quot;</span><span class="hljs-variable">$3</span><br>&#125;<br>[root@node-1 ~]<span class="hljs-comment"># awk -f awk.txt recode.txt</span><br></code></pre></td></tr></table></figure><p>在&quot;&quot;分割符之内，符合\n分割的会被打印出来</p><p>OFS 输出字段分隔符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;FS=&quot;:&quot;;OFS=&quot;#&quot;&#125;&#123;print $1,$2,$3&#125;&#x27; hello.txt</span><br>root<span class="hljs-comment">#x#0</span><br>bin<span class="hljs-comment">#x#1</span><br></code></pre></td></tr></table></figure><p>ORS 输出记录分隔符</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># cat awk.txt</span><br><span class="hljs-comment">#!/bin/awk</span><br>BEGIN &#123;<br>FS=<span class="hljs-string">&quot;\n&quot;</span><br>RS=<span class="hljs-string">&quot;&quot;</span><br>ORS=<span class="hljs-string">&quot;\n\n&quot;</span><br>&#125;<br>&#123;<br><span class="hljs-built_in">print</span> <span class="hljs-variable">$1</span><span class="hljs-string">&quot;,&quot;</span><span class="hljs-variable">$2</span><span class="hljs-string">&quot;,&quot;</span><span class="hljs-variable">$3</span><br>&#125;<br>[root@node-1 ~]<span class="hljs-comment"># awk -f awk.txt recode.txt</span><br>Jimmy the Weasel,100 Pleasant Drive,San Francisco,CA 123456<br>Big Tony,200 Incognito Ave.,Suburbia,WA 64890<br></code></pre></td></tr></table></figure><h2 id="awk正则">awk正则</h2><table><thead><tr><th>元字符</th><th>功能</th><th>示例</th><th>解释</th></tr></thead><tbody><tr><td>^</td><td>首航定位符</td><td>/^root/</td><td>匹配所有以root开头的行</td></tr><tr><td>行尾定位符/root/</td><td>匹配所有以root结尾的行</td><td></td><td></td></tr><tr><td>.</td><td>匹配任意单个字符</td><td>/r…t/</td><td>匹配字母r,然后两个任意字符，再以t结尾的行</td></tr><tr><td>*</td><td>匹配0个或多个前导字符(包括回车)</td><td>/a*ool/</td><td>匹配0个或多个a之后紧跟着ool的行，比如ool，aaaaool 等</td></tr><tr><td>+</td><td>匹配1个或多个前导字符</td><td>/a+b/</td><td>ab, aaab</td></tr><tr><td>?</td><td>匹配0个或1个前导字符</td><td>/a?b/</td><td>b，ab</td></tr><tr><td>[]</td><td>匹配指定字符组内的任意一个字符</td><td>/<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup>/</td><td>匹配以a或b或c开头的行</td></tr><tr><td>[^]</td><td>匹配不在指定字符组内任意一个字符</td><td><code>/^[^abc]/</code></td><td>匹配不以字母a或b或c开头的行</td></tr><tr><td>()</td><td>子表达式组合</td><td>/(rool)+/</td><td>表示一个或多个rool组合，当有一些字符需要组合时，使用括号括起来</td></tr><tr><td>|</td><td>或者的意思</td><td>/(root)|B/</td><td>匹配root或者B的行</td></tr><tr><td>\</td><td>转义字符</td><td>/a///</td><td>匹配a//</td></tr><tr><td><sub>,!</sub></td><td>匹配，不匹配的条件语句</td><td>$1~/root/</td><td>匹配第一个字段包含字符 root的所有记录</td></tr><tr><td>x{m}x{m,}x{m,n}</td><td>x重复m次x重复至少m次x重复至少m次，但是不超过n次</td><td>/(root) {3}//(root) {3,}//(root) {3,6}/</td><td></td></tr></tbody></table><p>正则应用</p><p>规则表达式</p><p>awk '/REG/{action} ’ file ,/REG/为正则表达式，可以将$0 中，满足条件的记录送入到：action 进行处理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;/root/&#123;print$0&#125;&#x27; /etc/passwd</span><br>root:x:0:0:root:/root:/bin/bash<br>operator:x:11:0:operator:/root:/sbin/nologin<br>[root@node-1 ~]<span class="hljs-comment"># awk -F &quot;:&quot; &#x27;$5~/root/&#123;print$0&#125;&#x27; /etc/passwd</span><br>root:x:0:0:root:/root:/bin/bash<br>[root@node-1 ~]<span class="hljs-comment"># ifconfig br0 | awk &#x27;BEGIN&#123;FS=&quot;[[:space:]:]+&quot;&#125;NR==2&#123;print$3&#125;&#x27;</span><br>192.168.0.241<br></code></pre></td></tr></table></figure><p>布尔表达式</p><p>awk ‘布尔表达式{action}’ file 仅当对前面的布尔表达式求值为真时， awk 才执行代码块。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk -F: &#x27;$1==&quot;root&quot;&#123;print$0&#125;&#x27; /etc/passwd</span><br>root:x:0:0:root:/root:/bin/bash<br>[root@node-1 ~]<span class="hljs-comment"># awk -F: &#x27;($1==&quot;root&quot;)&amp;&amp;($5==&quot;root&quot;)&#123;print$0&#125;&#x27; /etc/passwd</span><br>root:x:0:0:root:/root:/bin/bash<br></code></pre></td></tr></table></figure><h2 id="awk-的-if、循环和数组">awk 的 if、循环和数组</h2><h3 id="if">if</h3><p>条件语句</p><p>awk 提供了非常好的类似于 C 语言的 if 语句。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>	<span class="hljs-keyword">if</span> (<span class="hljs-variable">$1</span>==<span class="hljs-string">&quot;foo&quot;</span>)&#123;<br>	<span class="hljs-keyword">if</span> (<span class="hljs-variable">$2</span>==<span class="hljs-string">&quot;foo&quot;</span>)&#123;<br>		<span class="hljs-built_in">print</span><span class="hljs-string">&quot;uno&quot;</span><br>	&#125;<span class="hljs-keyword">else</span>&#123;<br>		<span class="hljs-built_in">print</span><span class="hljs-string">&quot;one&quot;</span><br>	&#125;<br>  &#125;elseif(<span class="hljs-variable">$1</span>==<span class="hljs-string">&quot;bar&quot;</span>)&#123;<br>	<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;two&quot;</span><br>  &#125;<span class="hljs-keyword">else</span>&#123;<br>	<span class="hljs-built_in">print</span><span class="hljs-string">&quot;three&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>使用 if 语句还可以将代码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">! /matchme/ &#123; <span class="hljs-built_in">print</span> <span class="hljs-variable">$1</span> <span class="hljs-variable">$3</span> <span class="hljs-variable">$4</span> &#125;<br></code></pre></td></tr></table></figure><p>转换成：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>	<span class="hljs-keyword">if</span> ( <span class="hljs-variable">$0</span> !~ /matchme/ ) &#123;<br>		<span class="hljs-built_in">print</span> <span class="hljs-variable">$1</span> <span class="hljs-variable">$3</span> <span class="hljs-variable">$4</span><br>	&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="while">while</h3><p>循环结构</p><p>我们已经看到了 awk 的 while 循环结构，它等同于相应的 C 语言 while 循环。 awk 还有&quot;do…while&quot;循 环，它在代码块结尾处对条件求值，而不像标准 while 循环那样在开始处求值。</p><p>它类似于其它语言中的&quot;repeat…until&quot;循环。以下是一个示例：</p><p>do…while 示例</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>	count=1do &#123;<br>		<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;I get printed at least once no matter what&quot;</span><br>	&#125; <span class="hljs-keyword">while</span> ( count !=1 )<br>&#125;<br></code></pre></td></tr></table></figure><p>与一般的 while 循环不同，由于在代码块之后对条件求值， &quot;do…while&quot;循环永远都至少执行一次。换句 话说，当第一次遇到普通 while 循环时，如果条件为假，将永远不执行该循环。</p><h3 id="for-循环">for 循环</h3><p>awk 允许创建 for 循环，它就象 while 循环，也等同于 C 语言的 for 循环：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> ( initial assignment; comparison; increment ) &#123;<br>	code block<br>&#125;<br></code></pre></td></tr></table></figure><p>以下是一个简短示例：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> ( x=1;x&lt;=4;x++ ) &#123;<br>	<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;iteration&quot;</span>, x<br>&#125;<br></code></pre></td></tr></table></figure><p>break 和 continue</p><p>此外，如同 C 语言一样， awk 提供了 break 和 continue 语句。使用这些语句可以更好地控制 awk 的 循环结构。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/awk</span><br>BEGIN&#123;<br>x=1<br><span class="hljs-keyword">while</span>(1) &#123;<br>	<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;iteration&quot;</span>,x<br>	<span class="hljs-keyword">if</span> ( x==10 )&#123;<br>		<span class="hljs-built_in">break</span><br>	&#125;<br>	x++<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>continue 语句补充了 break</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">x=1<br><span class="hljs-keyword">while</span> (1) &#123;<br>		<span class="hljs-keyword">if</span> ( x==4 ) &#123;<br>		x++<br>		<span class="hljs-built_in">continue</span><br>	&#125;<br>	<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;iteration&quot;</span>, x<br>	<span class="hljs-keyword">if</span> ( x&gt;20 ) &#123;<br>		<span class="hljs-built_in">break</span><br>	&#125;<br>	x++<br>&#125;<br></code></pre></td></tr></table></figure><p>continue在for中使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/awk</span><br>BEGIN&#123;<br><span class="hljs-keyword">for</span> (x=1;x&lt;=21;x++)&#123;<br><span class="hljs-keyword">if</span> (x==4)&#123;<br>	<span class="hljs-built_in">continue</span><br>&#125;<br>	<span class="hljs-built_in">print</span> <span class="hljs-string">&quot;iteration&quot;</span>,x<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="数组">数组</h3><p>AWK 中的数组都是关联数组,数字索引也会转变为字符串索引</p><p>在awk中，数组叫关联数组，与我们在其它编程语言中的数组有很大的区别。关联数组，简单来说，类 似于python语言中的dict、java语言中的map，其下标不再局限于数值型，而可以是字符串，即下标为 key，value=array[key]。竟然为key，那其下标也不再是有序的啦。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-meta">#!/bin/awk</span><br>BEGIN&#123;<br>    cities[1]=<span class="hljs-string">&quot;beijing&quot;</span><br>    cities[2]=<span class="hljs-string">&quot;shanghai&quot;</span><br>    cities[<span class="hljs-string">&quot;three&quot;</span>]=<span class="hljs-string">&quot;guangzhou&quot;</span><br>    <span class="hljs-keyword">for</span>( c <span class="hljs-keyword">in</span> cities) &#123;<br>    	<span class="hljs-built_in">print</span> cities[c]<br>    &#125;<br>    <span class="hljs-built_in">print</span> cities[1]<br>    <span class="hljs-built_in">print</span> cities[<span class="hljs-string">&quot;1&quot;</span>]<br>    <span class="hljs-built_in">print</span> cities[<span class="hljs-string">&quot;three&quot;</span>]<br>&#125;<br></code></pre></td></tr></table></figure><p>用 awk 中查看服务器连接状态并汇总</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># netstat -an|awk &#x27;/^tcp/&#123;++s[$NF]&#125;END&#123;for(a in s)printa,s[a]&#125;&#x27;</span><br>LISTEN 8<br>ESTABLISHED 1<br></code></pre></td></tr></table></figure><h2 id="常用字符串函数">常用字符串函数</h2><p><img src="image-20220812093929092.png" srcset="/img/loading.gif" lazyload alt="常用字符串函数"></p><p>字符串函数的应用</p><p>在 info 中查找满足正则表达式， /[0-9]+/ 用”!”替换，并且替换后的值，赋值给 info</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test2010test!&quot;;gsub(/[0-9]+/,&quot;!&quot;,info);print info&#125;&#x27;</span><br>this is a <span class="hljs-built_in">test</span>!<span class="hljs-built_in">test</span>!<br></code></pre></td></tr></table></figure><p>如果查找到数字则匹配成功返回 ok，否则失败，返回未找到</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test2010test!&quot;;printindex(info,&quot;test&quot;)?&quot;ok&quot;:&quot;no found&quot;;&#125;&#x27;</span><br>ok<br></code></pre></td></tr></table></figure><p>从第 4 个 字符开始，截取 10 个长度字符串</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test2010test!&quot;;print</span><br>substr(info,4,10);&#125;<span class="hljs-string">&#x27;</span><br><span class="hljs-string">s is a tes</span><br></code></pre></td></tr></table></figure><p>分割 info,动态创建数组 tA,awk for …in 循环，是一个无序的循环。 并不是从数组下标1…n 开始</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@node-1 ~]<span class="hljs-comment"># awk &#x27;BEGIN&#123;info=&quot;this is a test&quot;;split(info,tA,&quot; &quot;);print</span><br>length(tA);<span class="hljs-keyword">for</span>(k <span class="hljs-keyword">in</span> tA)&#123;<span class="hljs-built_in">print</span> k,tA[k];&#125;&#125;<span class="hljs-string">&#x27;</span><br><span class="hljs-string">4</span><br><span class="hljs-string">4 test</span><br><span class="hljs-string">1 this</span><br><span class="hljs-string">2 is</span><br><span class="hljs-string">3 a</span><br></code></pre></td></tr></table></figure><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>abc <a href="#fnref1" class="footnote-backref">↩︎</a></p></li></ol></section></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Linux/" class="category-chain-item">Linux</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/%E6%96%87%E6%9C%AC%E4%B8%89%E5%89%91%E5%AE%A2/">#文本三剑客</a></div></div><div class="license-box my-3"><div class="license-title"><div>文本三剑客</div><div>https://xiaolaji.site/20220905/文本三剑客/</div></div><div class="license-meta"><div class="license-meta-item"><div>Author</div><div>Xiaolaji</div></div><div class="license-meta-item license-meta-date"><div>Posted on</div><div>September 5, 2022</div></div><div class="license-meta-item"><div>Licensed under</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - Attribution"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - Non-commercial"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - Share-alike"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/20220905/Shell%E8%84%9A%E6%9C%AC%E7%BC%96%E7%A8%8B/" title="Shell脚本编程"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">Shell脚本编程</span> <span class="visible-mobile">Previous</span></a></article><article class="post-next col-6"><a href="/20220905/Linux%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/" title="Linux文件管理"><span class="hidden-mobile">Linux文件管理</span> <span class="visible-mobile">Next</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><div id="waline"></div><script type="text/javascript">Fluid.utils.loadComments("#waline",function(){Fluid.utils.createCssLink("https://lib.baomitu.com/waline/2.14.1/waline.min.css"),Fluid.utils.createScript("https://lib.baomitu.com/waline/2.14.1/waline.min.js",function(){var i=Object.assign({serverURL:"https://api.xiaolaji.site/",path:"window.location.pathname",meta:["nick","mail","link"],requiredMeta:["nick"],lang:"zh-CN",emoji:["https://unpkg.com/@waline/emojis@1.1.0/tw-emoji"],dark:'html[data-user-color-scheme="dark"]',wordLimit:0,pageSize:10},{el:"#waline",path:window.location.pathname});Waline.init(i),Fluid.utils.waitElementVisible("#waline .vcontent",()=>{var i="#waline .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>Table of Contents</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">Search</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">Keyword</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">Views: <span id="busuanzi_value_site_pv"></span> </span><span id="busuanzi_container_site_uv" style="display:none">Visitors: <span id="busuanzi_value_site_uv"></span></span></div><div class="beian"><span><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">苏ICP备2022037338号-1</a></span></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,t=t.getElementById("subtitle");t&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script>Fluid.plugins.imageCaption()</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">Blog works best with JavaScript enabled</div></noscript></body></html>